<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tuya iOS Home SDK: SGQRCode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="tuya.png"/></td>
  <td id="projectalign">
   <div id="projectname">Tuya iOS Smart Life App SDK API Doc<span id="projectnumber">&#160;4.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__pods__s_g_q_r_code__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SGQRCode </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version   </th><th class="markdownTableHeadCenter">UIKit   </th><th class="markdownTableHeadCenter">Use    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">3.5x   </td><td class="markdownTableBodyCenter">iOS 9.0+   </td><td class="markdownTableBodyCenter">Block    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">4.x   </td><td class="markdownTableBodyCenter">iOS 11.0+   </td><td class="markdownTableBodyCenter">Delegate   </td></tr>
</table>
<ul>
<li>QQ群：825339547</li>
<li><a href="https://github.com/kingsic/SGQRCode/wiki/3.5.1版本API说明">3.5.1版本 API 使用说明</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
主要功能</h1>
<p ><code>生成二维码</code><br  />
</p>
<p ><code>扫描二维码</code><br  />
</p>
<p ><code>捕获内容缩放功能</code><br  />
</p>
<p ><code>图片中识别二维码</code><br  />
</p>
<p ><code>相机、相册权限判断</code><br  />
</p>
<p ><code>根据光线强弱开启关闭手电筒</code><br  />
</p>
<p ><code>扫描成功后界面间的逻辑跳转处理</code><br  />
</p>
<p ><code>扫描界面可高度自定义（满足所有主流app）</code><br  />
</p>
<h1><a class="anchor" id="autotoc_md2"></a>
主要类说明</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">类名   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="interface_s_g_scan_code.html">SGScanCode</a>   </td><td class="markdownTableBodyNone">扫描二维码    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="interface_s_g_scan_view_configure.html">SGScanViewConfigure</a>   </td><td class="markdownTableBodyNone">扫描视图配置    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="interface_s_g_scan_view.html">SGScanView</a>   </td><td class="markdownTableBodyNone">扫描视图    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="interface_s_g_permission.html">SGPermission</a>   </td><td class="markdownTableBodyNone">相册、相机权限管理    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="interface_s_g_torch.html">SGTorch</a>   </td><td class="markdownTableBodyNone">手电筒管理    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="interface_s_g_q_r_code_log.html">SGQRCodeLog</a>   </td><td class="markdownTableBodyNone">调试日志   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md3"></a>
SGQRCode 集成流程</h1>
<p ><b>手动集成</b></p>
<p ><code>添加 SGQRCode 文件夹到工程中</code></p>
<p ><b>通过 CocoaPods 集成</b></p>
<p >&lsquo;pod 'SGQRCode&rsquo;, '~&gt; 4.1.0'`</p>
<p ><b>Info.plist 添加以下字段</b></p>
<p ><code>NSCameraUsageDescription (相机权限访问)</code><br  />
</p>
<p ><code>NSPhotoLibraryUsageDescription (相册权限访问)</code><br  />
</p>
<p ><b>引用头文件</b></p>
<p ><code>#import &lt;SGQRCode/SGQRCode.h&gt;</code></p>
<p ><b>扫描二维码相关代码</b> </p><div class="fragment"><div class="line"><span class="comment">// 创建二维码扫描类</span></div>
<div class="line">scanCode = [<a class="code hl_class" href="interface_s_g_scan_code.html">SGScanCode</a> <a class="code hl_function" href="interface_s_g_scan_code.html#ad4d8e7e33172cf998a50de5689e5075f">scanCode</a>];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 预览视图，必须设置</span></div>
<div class="line">scanCode.preview = <span class="keyword">self</span>.view;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 遵循 SGScanCodeDelegate</span></div>
<div class="line">scanCode.delegate = <span class="keyword">self</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 遵循 SGScanCodeSampleBufferDelegate</span></div>
<div class="line">scanCode.sampleBufferDelegate = <span class="keyword">self</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 开启扫描</span></div>
<div class="line">[scanCode startRunning];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 结束扫描</span></div>
<div class="line">[scanCode stopRunning];</div>
<div class="ttc" id="ainterface_s_g_scan_code_html"><div class="ttname"><a href="interface_s_g_scan_code.html">SGScanCode</a></div><div class="ttdef"><b>Definition:</b> <a href="_headers_2_private_2_s_g_q_r_code_2_s_g_scan_code_8h_source.html#l00012">SGScanCode.h:13</a></div></div>
<div class="ttc" id="ainterface_s_g_scan_code_html_ad4d8e7e33172cf998a50de5689e5075f"><div class="ttname"><a href="interface_s_g_scan_code.html#ad4d8e7e33172cf998a50de5689e5075f">+[SGScanCode scanCode]</a></div><div class="ttdeci">instancetype scanCode()</div><div class="ttdoc">类方法创建</div><div class="ttdef"><b>Definition:</b> <a href="_s_g_scan_code_8m_source.html#l00026">SGScanCode.m:37</a></div></div>
</div><!-- fragment --><p ><b>Delegate 方法</b> </p><div class="fragment"><div class="line"><span class="comment">// SGScanCodeDelegate</span></div>
<div class="line">- (void)scanCode:(<a class="code hl_class" href="interface_s_g_scan_code.html">SGScanCode</a> *)scanCode result:(NSString *)result {</div>
<div class="line">    &lt;#code#&gt;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// SGScanCodeSampleBufferDelegate</span></div>
<div class="line">- (void)scanCode:(<a class="code hl_class" href="interface_s_g_scan_code.html">SGScanCode</a> *)scanCode brightness:(CGFloat)brightness {</div>
<div class="line">    &lt;#code#&gt;</div>
<div class="line">}</div>
</div><!-- fragment --><p ><b>图片中识别二维码方法</b> </p><div class="fragment"><div class="line">[scanCode <a class="code hl_function" href="interface_s_g_scan_code.html#a1a86501a4502db7e3c3fab32e3495dc8">readQRCode</a>:image <a class="code hl_function" href="interface_s_g_scan_code.html#a1a86501a4502db7e3c3fab32e3495dc8">completion</a>:^(NSString *result) {</div>
<div class="line">    &lt;#code#&gt;</div>
<div class="line">}];</div>
<div class="ttc" id="ainterface_s_g_scan_code_html_a1a86501a4502db7e3c3fab32e3495dc8"><div class="ttname"><a href="interface_s_g_scan_code.html#a1a86501a4502db7e3c3fab32e3495dc8">-[SGScanCode readQRCode:completion:]</a></div><div class="ttdeci">void readQRCode:completion:(UIImage *image,[completion] void(^ completion)(NSString *result))</div><div class="ttdef"><b>Definition:</b> <a href="_s_g_scan_code_8m_source.html#l00026">SGScanCode.m:89</a></div></div>
</div><!-- fragment --><p ><b>生成二维码相关方法</b> </p><div class="fragment"><div class="line"><span class="comment">// 普通二维码生成方法</span></div>
<div class="line">[<a class="code hl_class" href="interface_s_g_generate_q_r_code.html">SGGenerateQRCode</a> <a class="code hl_function" href="interface_s_g_generate_q_r_code.html#a83dc71e19b0e033bf8a8f2a258e55f5c">generateQRCodeWithData</a>:data <a class="code hl_function" href="interface_s_g_generate_q_r_code.html#a83dc71e19b0e033bf8a8f2a258e55f5c">size</a>:size];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 带 logo 的二维码生成方法</span></div>
<div class="line">[<a class="code hl_class" href="interface_s_g_generate_q_r_code.html">SGGenerateQRCode</a> <a class="code hl_function" href="interface_s_g_generate_q_r_code.html#a2afb888125bc812c703933ce9218b54d">generateQRCodeWithData</a>:data <a class="code hl_function" href="interface_s_g_generate_q_r_code.html#a2afb888125bc812c703933ce9218b54d">size</a>:size <a class="code hl_function" href="interface_s_g_generate_q_r_code.html#a2afb888125bc812c703933ce9218b54d">logoImage</a>:logoImage <a class="code hl_function" href="interface_s_g_generate_q_r_code.html#a2afb888125bc812c703933ce9218b54d">ratio</a>:ratio];</div>
<div class="ttc" id="ainterface_s_g_generate_q_r_code_html"><div class="ttname"><a href="interface_s_g_generate_q_r_code.html">SGGenerateQRCode</a></div><div class="ttdef"><b>Definition:</b> <a href="_headers_2_private_2_s_g_q_r_code_2_s_g_generate_q_r_code_8h_source.html#l00013">SGGenerateQRCode.h:14</a></div></div>
<div class="ttc" id="ainterface_s_g_generate_q_r_code_html_a2afb888125bc812c703933ce9218b54d"><div class="ttname"><a href="interface_s_g_generate_q_r_code.html#a2afb888125bc812c703933ce9218b54d">+[SGGenerateQRCode generateQRCodeWithData:size:logoImage:ratio:]</a></div><div class="ttdeci">UIImage * generateQRCodeWithData:size:logoImage:ratio:(NSString *data,[size] CGFloat size,[logoImage] UIImage *logoImage,[ratio] CGFloat ratio)</div><div class="ttdef"><b>Definition:</b> <a href="_s_g_generate_q_r_code_8m_source.html#l00001">SGGenerateQRCode.m:36</a></div></div>
<div class="ttc" id="ainterface_s_g_generate_q_r_code_html_a83dc71e19b0e033bf8a8f2a258e55f5c"><div class="ttname"><a href="interface_s_g_generate_q_r_code.html#a83dc71e19b0e033bf8a8f2a258e55f5c">+[SGGenerateQRCode generateQRCodeWithData:size:]</a></div><div class="ttdeci">UIImage * generateQRCodeWithData:size:(NSString *data,[size] CGFloat size)</div><div class="ttdoc">生成二维码</div><div class="ttdef"><b>Definition:</b> <a href="_s_g_generate_q_r_code_8m_source.html#l00001">SGGenerateQRCode.m:13</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
效果图</h1>
<p ><img src="https://github.com/kingsic/SGQRCode/raw/master/Pictures/sgqrcode_1.png" alt="" width="40%" height="40%" class="inline"/> <img src="https://github.com/kingsic/SGQRCode/raw/master/Pictures/sgqrcode_2.png" alt="" width="40%" height="40%" class="inline"/> <img src="https://github.com/kingsic/SGQRCode/raw/master/Pictures/sgqrcode_3.png" alt="" width="40%" height="40%" class="inline"/> <img src="https://github.com/kingsic/SGQRCode/raw/master/Pictures/sgqrcode_4.png" alt="" width="40%" height="40%" class="inline"/> <img src="https://github.com/kingsic/SGQRCode/raw/master/Pictures/sgqrcode_5.png" alt="" width="40%" height="40%" class="inline"/> <img src="https://github.com/kingsic/SGQRCode/raw/master/Pictures/sgqrcode_6.png" alt="" width="40%" height="40%" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md5"></a>
问题及解决方案</h1>
<ul>
<li>若在使用 CocoaPods 安装第三方时，出现 [!] Unable to find a specification for SGQRCode 提示时，打开终端先输入 pod repo remove master；执行完毕后再输入 pod setup 即可 (可能会等待一段时间)</li>
<li>CIDetector 类只能识别图片中的二维码，目前暂不支持识别图片中的条形码 <a href="https://juejin.cn/post/6844903910428114952l">解决方案</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
更新说明</h1>
<ul>
<li>2021-07-05 ：v3.5.1 版本重构：修复 <a href="https://github.com/kingsic/SGQRCode/issues/163">#163</a> 问题，更多内容请在 <a href="https://github.com/kingsic/SGQRCode/releases/tag/3.5.1">releases</a> 中查看</li>
<li>2022-07-16 ：v4.0.0 版本重构：Delegate 取代 Block，新增手动对焦功能，优化拓展扫描视图，更多内容请在 <a href="https://github.com/kingsic/SGQRCode/releases/tag/4.0.0">releases</a> 中查看</li>
<li>2022-07-16 ：v4.1.0 优化SGScanView内部代码逻辑，修复无扫描线时，导致程序崩溃问题</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
License</h1>
<p >SGQRCode is released under the Apache License 2.0. See <a href="https://github.com/kingsic/SGQRCode/blob/master/LICENSE">LICENSE</a> for details. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
